{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://opensecurityarchitecture.org/schema/attack-metadata.schema.json",
  "title": "OSA ATT&CK Metadata",
  "description": "Provenance and version metadata for the ATT&CK enrichment dataset",
  "type": "object",
  "required": [
    "source",
    "source_url",
    "attack_version",
    "attack_domain",
    "nist_version",
    "mapping_framework_version",
    "total_mappings",
    "controls_mapped",
    "techniques_mapped",
    "families_covered",
    "enrichment_date"
  ],
  "additionalProperties": false,

  "properties": {
    "source": {
      "type": "string",
      "minLength": 1,
      "description": "Name of the mapping source organisation"
    },
    "source_url": {
      "type": "string",
      "format": "uri",
      "description": "URL to the mapping source repository or project"
    },
    "attack_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "description": "ATT&CK version (e.g., 16.1)"
    },
    "attack_domain": {
      "type": "string",
      "enum": ["enterprise", "mobile", "ics"],
      "description": "ATT&CK domain"
    },
    "nist_version": {
      "type": "string",
      "minLength": 1,
      "description": "NIST 800-53 revision used (e.g., NIST 800-53 Rev 5)"
    },
    "mapping_framework_version": {
      "type": "string",
      "description": "CTID mapping framework version identifier"
    },
    "total_mappings": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of technique-control mapping relationships"
    },
    "controls_mapped": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of unique NIST controls with ATT&CK mappings"
    },
    "techniques_mapped": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of unique ATT&CK techniques in the dataset"
    },
    "families_covered": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "pattern": "^[A-Z]{2}$",
        "description": "NIST 800-53 control family code"
      },
      "description": "NIST control families covered by the mapping"
    },
    "enrichment_date": {
      "type": "string",
      "format": "date",
      "description": "Date the enrichment was performed (ISO 8601)"
    },
    "notes": {
      "type": "string",
      "description": "Additional context or caveats about the mapping"
    }
  }
}
