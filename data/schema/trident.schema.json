{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/trident/trident.schema.json",
  "title": "TRIDENT Reference Ontology - JSON Schema Bundle",
  "type": "object",
  "description": "Bundle of canonical TRIDENT artifacts as JSON Schema $defs. Use $ref to validate individual artifact instances.",
  "$defs": {
    "Identifier": {
      "type": "string",
      "pattern": "^[A-Za-z0-9._:-]{6,128}$",
      "description": "Opaque, stable identifier (not a UUID requirement)."
    },
    "ISODateTime": {
      "type": "string",
      "format": "date-time"
    },
    "ISODate": {
      "type": "string",
      "format": "date"
    },
    "URI": {
      "type": "string",
      "format": "uri"
    },
    "Text": {
      "type": "string",
      "minLength": 1,
      "maxLength": 32768
    },
    "NonEmptyString": {
      "type": "string",
      "minLength": 1
    },
    "EnumLineOfDefense": {
      "type": "string",
      "enum": ["L1", "L2", "L3"]
    },
    "EnumEffect": {
      "type": "string",
      "enum": ["prevent", "detect", "respond", "recover"]
    },
    "EnumDecision": {
      "type": "string",
      "enum": ["accept", "avoid", "transfer", "mitigate"]
    },
    "EnumConfidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1
    },
    "Tags": {
      "type": "array",
      "items": { "type": "string", "maxLength": 64 },
      "maxItems": 64,
      "uniqueItems": true
    },
    "Meta": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "createdAt": { "$ref": "#/$defs/ISODateTime" },
        "createdBy": { "$ref": "#/$defs/NonEmptyString" },
        "updatedAt": { "$ref": "#/$defs/ISODateTime" },
        "updatedBy": { "$ref": "#/$defs/NonEmptyString" },
        "version": { "type": "string", "pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?$" },
        "sourceSystem": { "$ref": "#/$defs/NonEmptyString" },
        "labels": { "$ref": "#/$defs/Tags" }
      },
      "required": ["createdAt", "createdBy", "version"]
    },
    "EntityRef": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "type": { "$ref": "#/$defs/NonEmptyString" },
        "displayName": { "$ref": "#/$defs/NonEmptyString" }
      },
      "required": ["id", "type"]
    },
    "Owner": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "lod": { "$ref": "#/$defs/EnumLineOfDefense" },
        "team": { "$ref": "#/$defs/NonEmptyString" },
        "role": { "$ref": "#/$defs/NonEmptyString" },
        "person": { "$ref": "#/$defs/NonEmptyString" },
        "contact": { "$ref": "#/$defs/NonEmptyString" }
      },
      "required": ["lod", "team"]
    },
    "Scope": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "system": { "$ref": "#/$defs/EntityRef" },
        "businessProcess": { "$ref": "#/$defs/EntityRef" },
        "asset": { "$ref": "#/$defs/EntityRef" },
        "boundary": { "$ref": "#/$defs/Text" }
      }
    },
    "CPE": {
      "$id": "https://example.org/trident/cpe.schema.json",
      "type": "object",
      "additionalProperties": false,
      "description": "Common Platform Enumeration identifier. Hierarchical URI describing a platform/product/version. The convergence point where CVE, CCE, and XCCDF data meet the asset inventory.",
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "cpe23Uri": {
          "type": "string",
          "pattern": "^cpe:2\\.3:[aho\\*\\-]:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+:[^:]+$",
          "description": "CPE 2.3 formatted string (e.g., cpe:2.3:a:apache:http_server:2.4.51:*:*:*:*:*:*:*)"
        },
        "part": {
          "type": "string",
          "enum": ["a", "h", "o"],
          "description": "CPE part: a=application, h=hardware, o=operating system"
        },
        "vendor": { "$ref": "#/$defs/NonEmptyString" },
        "product": { "$ref": "#/$defs/NonEmptyString" },
        "version": { "type": "string", "maxLength": 64 },
        "update": { "type": "string", "maxLength": 64 },
        "edition": { "type": "string", "maxLength": 64 },
        "language": { "type": "string", "maxLength": 16 },
        "parentCpe": {
          "$ref": "#/$defs/EntityRef",
          "description": "Reference to a parent CPE in the hierarchy (e.g., version-less CPE for a versioned entry)"
        },
        "title": { "$ref": "#/$defs/NonEmptyString" }
      },
      "required": ["id", "meta", "cpe23Uri", "part", "vendor", "product"]
    },
    "XCCDFChecklist": {
      "$id": "https://example.org/trident/xccdf-checklist.schema.json",
      "type": "object",
      "additionalProperties": false,
      "description": "NIST National Checklist Program (NCP) security configuration checklist in XCCDF format. Defines hardening baselines for specific platforms.",
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "ncpId": {
          "type": "string",
          "description": "NIST NCP checklist identifier"
        },
        "title": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "benchmarkVersion": { "type": "string", "maxLength": 32 },
        "applicableCPEs": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "minItems": 1,
          "maxItems": 64,
          "description": "CPE identifiers this checklist targets"
        },
        "controlRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/ExternalStandardRef" },
          "maxItems": 256,
          "description": "SP800-53 controls referenced by this checklist's rules"
        },
        "cceRefs": {
          "type": "array",
          "items": { "type": "string", "pattern": "^CCE-[0-9]+-[0-9]+$" },
          "maxItems": 512,
          "description": "CCE identifiers covered by this checklist"
        },
        "source": {
          "$ref": "#/$defs/URI",
          "description": "URL to the NCP repository entry or SCAP content"
        }
      },
      "required": ["id", "meta", "title", "applicableCPEs"]
    },
    "ExternalStandardRef": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "scheme": {
          "type": "string",
          "enum": ["ATTACK", "CIS", "NIST_800_53", "RMF", "ISO_27001", "ISO_31000", "FAIR", "CVE", "CWE", "CCE", "CPE", "XCCDF", "OTHER"]
        },
        "id": { "$ref": "#/$defs/NonEmptyString" },
        "version": { "type": "string", "maxLength": 32 },
        "url": { "$ref": "#/$defs/URI" }
      },
      "required": ["scheme", "id"]
    },
    "EvidenceLink": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["ticket", "doc", "report", "telemetry", "runbook", "code", "config", "scan", "log", "other"]
        },
        "url": { "$ref": "#/$defs/URI" },
        "uri": { "$ref": "#/$defs/URI" },
        "hash": { "type": "string", "maxLength": 128 },
        "description": { "$ref": "#/$defs/Text" },
        "capturedAt": { "$ref": "#/$defs/ISODateTime" }
      },
      "required": ["kind", "description"]
    },
    "MetricDefinition": {
      "$id": "https://example.org/trident/metric-definition.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "type": {
          "type": "string",
          "enum": ["coverage", "effectiveness", "timeliness", "quality", "volume", "rate", "other"]
        },
        "unit": { "type": "string", "maxLength": 32 },
        "valueType": { "type": "string", "enum": ["number", "integer", "boolean", "string"] },
        "calculation": { "$ref": "#/$defs/Text" },
        "collectionMethod": { "$ref": "#/$defs/Text" },
        "target": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "operator": { "type": "string", "enum": [">", ">=", "<", "<=", "=="] },
            "value": {}
          },
          "required": ["operator", "value"]
        }
      },
      "required": ["id", "meta", "name", "type", "valueType"]
    },
    "MetricObservation": {
      "$id": "https://example.org/trident/metric-observation.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "metric": { "$ref": "#/$defs/EntityRef" },
        "scope": { "$ref": "#/$defs/Scope" },
        "observedAt": { "$ref": "#/$defs/ISODateTime" },
        "value": {},
        "confidence": { "$ref": "#/$defs/EnumConfidence" },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 32
        }
      },
      "required": ["id", "meta", "metric", "observedAt", "value"]
    },
    "Scenario": {
      "$id": "https://example.org/trident/scenario.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "scope": { "$ref": "#/$defs/Scope" },
        "objectives": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "minItems": 1,
          "maxItems": 32
        },
        "lossEventType": { "$ref": "#/$defs/NonEmptyString" },
        "fairModel": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "lossFrequency": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "distribution": { "type": "string", "enum": ["point", "triangular", "pert", "lognormal", "custom"] },
                "p10": { "type": "number" },
                "p50": { "type": "number" },
                "p90": { "type": "number" },
                "unit": { "type": "string", "enum": ["per_year", "per_month", "per_week", "per_day"] },
                "drivers": {
                  "type": "array",
                  "items": { "$ref": "#/$defs/Text" },
                  "maxItems": 32
                }
              },
              "required": ["distribution", "unit"]
            },
            "lossMagnitude": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "currency": { "type": "string", "minLength": 3, "maxLength": 3 },
                "distribution": { "type": "string", "enum": ["point", "triangular", "pert", "lognormal", "custom"] },
                "p10": { "type": "number" },
                "p50": { "type": "number" },
                "p90": { "type": "number" },
                "drivers": {
                  "type": "array",
                  "items": { "$ref": "#/$defs/Text" },
                  "maxItems": 32
                }
              },
              "required": ["currency", "distribution"]
            }
          },
          "required": ["lossFrequency", "lossMagnitude"]
        },
        "attackPaths": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "minItems": 1,
          "maxItems": 32
        },
        "capabilities": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "sensitivityDrivers": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 16
        },
        "status": {
          "type": "string",
          "enum": ["draft", "active", "retired"]
        },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "name", "lossEventType", "fairModel", "attackPaths", "owners", "status"]
    },
    "AttackTechnique": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "attack": { "$ref": "#/$defs/ExternalStandardRef" },
        "tactic": { "type": "string", "maxLength": 64 },
        "techniqueId": { "type": "string", "pattern": "^T[0-9]{4}(\\.[0-9]{3})?$" },
        "name": { "$ref": "#/$defs/NonEmptyString" }
      },
      "required": ["techniqueId"]
    },
    "ExposureCondition": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "description": { "$ref": "#/$defs/Text" },
        "category": { "type": "string", "enum": ["identity", "network", "endpoint", "application", "data", "cloud", "third_party", "other"] }
      },
      "required": ["description"]
    },
    "AttackPath": {
      "$id": "https://example.org/trident/attack-path.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "scope": { "$ref": "#/$defs/Scope" },
        "techniques": {
          "type": "array",
          "minItems": 1,
          "maxItems": 64,
          "items": { "$ref": "#/$defs/AttackTechnique" }
        },
        "exposureConditions": {
          "type": "array",
          "items": { "$ref": "#/$defs/ExposureCondition" },
          "maxItems": 32
        },
        "relevantActors": {
          "type": "array",
          "items": { "$ref": "#/$defs/NonEmptyString" },
          "maxItems": 16
        },
        "mappedCapabilities": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "lastValidatedAt": { "$ref": "#/$defs/ISODateTime" },
        "validationStatus": { "type": "string", "enum": ["unknown", "pass", "fail", "partial"] },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "name", "techniques", "owners"]
    },
    "Capability": {
      "$id": "https://example.org/trident/capability.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "effects": {
          "type": "array",
          "items": { "$ref": "#/$defs/EnumEffect" },
          "minItems": 1,
          "uniqueItems": true
        },
        "cisSafeguards": {
          "type": "array",
          "items": { "$ref": "#/$defs/ExternalStandardRef" },
          "maxItems": 16
        },
        "mitigatesTechniques": {
          "type": "array",
          "items": { "$ref": "#/$defs/AttackTechnique" },
          "maxItems": 128
        },
        "controlRequirements": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "metricDefinitions": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 16
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "status": { "type": "string", "enum": ["planned", "implemented", "deprecated"] },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "name", "effects", "owners", "status"]
    },
    "ControlRequirement": {
      "$id": "https://example.org/trident/control-requirement.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "standardRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/ExternalStandardRef" },
          "minItems": 1,
          "maxItems": 16
        },
        "parameters": {
          "type": "object",
          "additionalProperties": true
        },
        "assessmentApproach": {
          "type": "array",
          "items": { "type": "string", "enum": ["examine", "interview", "test", "automated"] },
          "minItems": 1,
          "uniqueItems": true
        },
        "implementations": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "name", "standardRefs", "assessmentApproach", "owners"]
    },
    "Implementation": {
      "$id": "https://example.org/trident/implementation.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "type": {
          "type": "string",
          "enum": ["product", "config", "process", "policy"],
          "description": "How the control is realised: product (tool/technology), config (hardening setting), process (operational procedure), or policy (documented requirement)"
        },
        "scope": { "$ref": "#/$defs/Scope" },
        "technology": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "product": { "$ref": "#/$defs/NonEmptyString" },
            "vendor": { "$ref": "#/$defs/NonEmptyString" },
            "service": { "$ref": "#/$defs/NonEmptyString" },
            "version": { "type": "string", "maxLength": 64 }
          }
        },
        "configRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 32
        },
        "xccdfRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 16,
          "description": "XCCDF checklists that define this config implementation"
        },
        "cpeScope": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64,
          "description": "CPE identifiers describing which platforms this implementation applies to"
        },
        "producesTelemetry": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "supportsCapabilities": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "status": { "type": "string", "enum": ["active", "inactive", "retired"] }
      },
      "required": ["id", "meta", "name", "owners", "status"]
    },
    "TelemetrySignal": {
      "$id": "https://example.org/trident/telemetry-signal.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "source": { "$ref": "#/$defs/NonEmptyString" },
        "signalType": { "type": "string", "enum": ["log", "event", "alert", "metric", "trace", "other"] },
        "schemaHint": { "type": "string", "maxLength": 128 },
        "mappedTechniques": {
          "type": "array",
          "items": { "$ref": "#/$defs/AttackTechnique" },
          "maxItems": 64
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        }
      },
      "required": ["id", "meta", "name", "source", "signalType", "owners"]
    },
    "TestCase": {
      "$id": "https://example.org/trident/test-case.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "name": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "scope": { "$ref": "#/$defs/Scope" },
        "exercisesCapabilities": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "minItems": 1,
          "maxItems": 32
        },
        "targetsTechniques": {
          "type": "array",
          "items": { "$ref": "#/$defs/AttackTechnique" },
          "minItems": 1,
          "maxItems": 64
        },
        "method": { "type": "string", "enum": ["purple_team", "automated_emulation", "tabletop", "unit_test", "integration_test", "audit_test"] },
        "steps": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 128
        },
        "successCriteria": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "minItems": 1,
          "maxItems": 32
        },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        }
      },
      "required": ["id", "meta", "name", "exercisesCapabilities", "targetsTechniques", "method", "successCriteria", "owners"]
    },
    "TestResult": {
      "$id": "https://example.org/trident/test-result.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "testCase": { "$ref": "#/$defs/EntityRef" },
        "executedAt": { "$ref": "#/$defs/ISODateTime" },
        "outcome": { "type": "string", "enum": ["pass", "fail", "partial", "error"] },
        "confidence": { "$ref": "#/$defs/EnumConfidence" },
        "observations": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 64
        },
        "metricObservations": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 32
        },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "testCase", "executedAt", "outcome"]
    },
    "Vulnerability": {
      "$id": "https://example.org/trident/vulnerability.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "cve": { "type": "string", "pattern": "^CVE-[0-9]{4}-[0-9]{4,}$" },
        "title": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "cwe": {
          "type": "array",
          "items": { "type": "string", "pattern": "^CWE-[0-9]+$" },
          "maxItems": 16
        },
        "affected": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "product": { "$ref": "#/$defs/NonEmptyString" },
              "version": { "type": "string", "maxLength": 64 },
              "assetRef": { "$ref": "#/$defs/EntityRef" }
            },
            "required": ["product"]
          },
          "maxItems": 256
        },
        "affectedCPEs": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 256,
          "description": "Structured CPE references for affected platforms (supplements freetext affected.product)"
        },
        "exploitabilityWindow": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "disclosedAt": { "$ref": "#/$defs/ISODateTime" },
            "patchedAt": { "$ref": "#/$defs/ISODateTime" },
            "mitigatedAt": { "$ref": "#/$defs/ISODateTime" }
          }
        },
        "references": {
          "type": "array",
          "items": { "$ref": "#/$defs/URI" },
          "maxItems": 32
        }
      },
      "required": ["id", "meta", "title"]
    },
    "Finding": {
      "$id": "https://example.org/trident/finding.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "title": { "$ref": "#/$defs/NonEmptyString" },
        "description": { "$ref": "#/$defs/Text" },
        "type": { "type": "string", "enum": ["vulnerability", "misconfiguration", "control_gap", "process_gap", "detection_gap", "other"] },
        "severity": { "type": "string", "enum": ["critical", "high", "medium", "low", "info"] },
        "scope": { "$ref": "#/$defs/Scope" },
        "relatesTo": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "rootCause": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 16
        },
        "recommendedActions": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 32
        },
        "status": { "type": "string", "enum": ["open", "in_progress", "mitigated", "accepted", "false_positive", "closed"] },
        "owners": {
          "type": "array",
          "items": { "$ref": "#/$defs/Owner" },
          "minItems": 1,
          "maxItems": 16
        },
        "evidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 64
        }
      },
      "required": ["id", "meta", "title", "type", "severity", "status", "owners"]
    },
    "RiskTreatmentDecision": {
      "$id": "https://example.org/trident/risk-treatment-decision.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "scenario": { "$ref": "#/$defs/EntityRef" },
        "decision": { "$ref": "#/$defs/EnumDecision" },
        "rationale": { "$ref": "#/$defs/Text" },
        "residualRiskStatement": { "$ref": "#/$defs/Text" },
        "constraints": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 32
        },
        "linkedEvidence": {
          "type": "array",
          "items": { "$ref": "#/$defs/EvidenceLink" },
          "maxItems": 32
        },
        "approvedBy": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "lod": { "$ref": "#/$defs/EnumLineOfDefense" },
            "name": { "$ref": "#/$defs/NonEmptyString" },
            "role": { "$ref": "#/$defs/NonEmptyString" },
            "approvedAt": { "$ref": "#/$defs/ISODateTime" }
          },
          "required": ["lod", "name", "approvedAt"]
        }
      },
      "required": ["id", "meta", "scenario", "decision", "rationale", "approvedBy"]
    },
    "AuthorizationDecision": {
      "$id": "https://example.org/trident/authorization-decision.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "system": { "$ref": "#/$defs/EntityRef" },
        "rmfRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/ExternalStandardRef" },
          "maxItems": 16
        },
        "decision": { "type": "string", "enum": ["authorize", "authorize_with_conditions", "deny", "revoke"] },
        "conditions": {
          "type": "array",
          "items": { "$ref": "#/$defs/Text" },
          "maxItems": 32
        },
        "acceptedRisks": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 64
        },
        "authorizedBy": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "name": { "$ref": "#/$defs/NonEmptyString" },
            "role": { "$ref": "#/$defs/NonEmptyString" },
            "authorizedAt": { "$ref": "#/$defs/ISODateTime" }
          },
          "required": ["name", "authorizedAt"]
        }
      },
      "required": ["id", "meta", "system", "decision", "authorizedBy"]
    },
    "AssuranceOpinion": {
      "$id": "https://example.org/trident/assurance-opinion.schema.json",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/Identifier" },
        "meta": { "$ref": "#/$defs/Meta" },
        "scope": { "$ref": "#/$defs/Scope" },
        "issuedBy": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "lod": { "type": "string", "enum": ["L3"] },
            "function": { "type": "string", "enum": ["internal_audit", "external_audit", "regulator", "other"] },
            "org": { "$ref": "#/$defs/NonEmptyString" },
            "lead": { "$ref": "#/$defs/NonEmptyString" }
          },
          "required": ["lod", "function"]
        },
        "opinion": { "type": "string", "enum": ["effective", "partially_effective", "ineffective", "inconclusive"] },
        "basis": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntityRef" },
          "maxItems": 128
        },
        "narrative": { "$ref": "#/$defs/Text" },
        "issuedAt": { "$ref": "#/$defs/ISODateTime" }
      },
      "required": ["id", "meta", "issuedBy", "opinion", "issuedAt"]
    }
  }
}
